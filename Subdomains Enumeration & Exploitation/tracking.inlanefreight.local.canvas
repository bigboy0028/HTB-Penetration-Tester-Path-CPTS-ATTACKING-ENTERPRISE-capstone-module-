{
	"nodes":[
		{"id":"961c12cd21b980fa","type":"text","text":"The site at http://tracking.inlanefreight.local/ allows us to enter a tracking number and receive a PDF showing the status of our order. The application takes user input and generates a PDF document. Upon PDF generation, we can see that the Tracking #: field takes any input (not just numbers) that we specify in the search box before hitting the Track Now button. If we insert a simple JavaScript payload such as <script>document.write('TESTING THIS')</script> and click Track Now, we see that the PDF is generated and the message TESTING THIS is rendered, which seems to mean that the JavaScript code is executing when the webserver generates the document.","x":-1060,"y":-420,"width":780,"height":200},
		{"id":"f99151f10fda651c","type":"file","file":"Pasted image 20250106161251.png","x":-1060,"y":-160,"width":900,"height":488},
		{"id":"64f6c9eb2d8125db","type":"text","text":"Let's dig through some of these writeups and see if we can produce a similar result and gain local file read. Following this post, let's test for local file read using XMLHttpRequest (XHR) objects and also consulting this excellent post on local file read via XSS in dynamically generated PDFS. We can use this payload to test for file read, first trying for the /etc/passwd file, which is world-readable and should confirm the vulnerability's existence.","x":20,"y":-2,"width":665,"height":172},
		{"id":"dda2480ea6b6764c","type":"file","file":"Pasted image 20250106161334.png","x":153,"y":380,"width":386,"height":239},
		{"id":"b9815b1a83b1d6d0","type":"file","file":"Pasted image 20250106161354.png","x":-87,"y":820,"width":867,"height":360},
		{"id":"feefbacd9c17a89f","type":"text","text":"It's worth reading these blog posts, studying this finding and its impact, and becoming familiar with this class of vulnerability. If we were to encounter something like this during a penetration test that we are unfamiliar with but seemed \"off,\" we could refer to the Penetration Testing Process to perform an analysis of the situation. If we did our research and still could not uncover the vulnerability, we should keep detailed notes of what we've tried and our thought process and ask our peers and more senior members of our team for assistance. Pentest teams often have folks who specialize or are stronger in certain areas, so someone on the team has likely seen this or something similar.\n\nPlay around with this vulnerability some more and see what else you can gain access to. For now, we'll note down another high-risk finding, SSRF to Local File Read, and move on.","x":-68,"y":1300,"width":830,"height":277,"color":"4"},
		{"id":"19d362d1b53da126","type":"file","file":"Pasted image 20250107164226.png","x":-75,"y":1780,"width":845,"height":340,"color":"4"},
		{"id":"a15a9376cd6176bd","type":"text","text":"<script> \tx=new XMLHttpRequest; \tx.onload=function(){   \tdocument.write(this.responseText)}; \tx.open(\"GET\",\"file:///flag.txt\"); \tx.send(); \t</script>","x":86,"y":2180,"width":522,"height":120,"color":"4"},
		{"id":"a07d8e491dcede4d","type":"text","text":"findings\n","x":262,"y":2338,"width":171,"height":62,"color":"1"},
		{"id":"3f65e50a9e5079f9","type":"text","text":"SSRF to Local File Read","x":222,"y":2480,"width":250,"height":60,"color":"6"}
	],
	"edges":[
		{"id":"d861b859cf679030","fromNode":"961c12cd21b980fa","fromSide":"bottom","toNode":"f99151f10fda651c","toSide":"top"},
		{"id":"624a11229c1243e0","fromNode":"f99151f10fda651c","fromSide":"right","toNode":"64f6c9eb2d8125db","toSide":"left"},
		{"id":"a58a93f0cdda91c3","fromNode":"64f6c9eb2d8125db","fromSide":"bottom","toNode":"dda2480ea6b6764c","toSide":"top"},
		{"id":"6ed491d637197be8","fromNode":"dda2480ea6b6764c","fromSide":"bottom","toNode":"b9815b1a83b1d6d0","toSide":"top"},
		{"id":"619db5812c7b19d6","fromNode":"b9815b1a83b1d6d0","fromSide":"bottom","toNode":"feefbacd9c17a89f","toSide":"top"},
		{"id":"50b03b2655787898","fromNode":"feefbacd9c17a89f","fromSide":"bottom","toNode":"19d362d1b53da126","toSide":"top"},
		{"id":"12f8dd275897e2f8","fromNode":"19d362d1b53da126","fromSide":"bottom","toNode":"a15a9376cd6176bd","toSide":"top"},
		{"id":"30b97b6acf0b2489","fromNode":"a07d8e491dcede4d","fromSide":"bottom","toNode":"3f65e50a9e5079f9","toSide":"top"},
		{"id":"bfe05be3cfe22e15","fromNode":"a15a9376cd6176bd","fromSide":"bottom","toNode":"a07d8e491dcede4d","toSide":"top"}
	]
}