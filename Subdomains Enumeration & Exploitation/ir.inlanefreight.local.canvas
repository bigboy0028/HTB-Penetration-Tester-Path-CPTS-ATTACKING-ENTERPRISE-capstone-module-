{
	"nodes":[
		{"id":"67612794f230ac57","type":"text","text":"The next target in our list is `http://ir.inlanefreight.local`, the company's Investor Relations Portal hosted with WordPress. For this we can consult the [WordPress - Discovery & Enumeration](https://academy.hackthebox.com/module/113/section/1100) section of the `Attacking Common Applications` module. Let's fire up `WPScan` and see what we can enumerate using the `-ap` flag to enumerate all plugins.","x":-1062,"y":-442,"width":822,"height":122},
		{"id":"943a91f8aa3ac0f3","type":"file","file":"Pasted image 20250106150843.png","x":-1062,"y":-240,"width":822,"height":600},
		{"id":"ab6d21dc3bf9b9c1","type":"text","text":"From the scan, we can deduce the following bits of information:\n\n    The WordPress core version is the latest (6.0 at the time of writing)\n    The theme in use is cbusiness-investment\n    The b2i-investor-tools plugin is installed\n    The mail-masta plugin is installed\n","x":-100,"y":-55,"width":725,"height":230},
		{"id":"7da8c627962fc8fe","type":"text","text":"The `Mail Masta` plugin is an older plugin with several known vulnerabilities. We can use [this](https://www.exploit-db.com/exploits/50226) exploit to read files on the underlying file system by leveraging a Local File Inclusion (LFI) vulnerability.","x":-110,"y":238,"width":745,"height":122},
		{"id":"f7ba56c4c36b59f7","type":"file","file":"Pasted image 20250106151120.png","x":-182,"y":460,"width":890,"height":369},
		{"id":"c3591316b1de10b6","type":"text","text":"We can add another finding to our list: Local File Inclusion (LFI). Next, let's move on and see if we can enumerate WordPress users using WPScan.","x":-100,"y":940,"width":727,"height":60},
		{"id":"430e66de81184f85","type":"file","file":"Pasted image 20250106151326.png","x":-182,"y":1116,"width":890,"height":680},
		{"id":"a509c3c8691c4f49","type":"text","text":"Let's try to brute-force one of the account passwords using [this](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/darkweb2017-top100.txt) wordlist from the `SecLists` GitHub repo. Using `WPScan` again, we get a hit for the `ilfreightwp` account.","x":-79,"y":1920,"width":685,"height":60},
		{"id":"45aecbeabfc38fc7","type":"file","file":"Pasted image 20250106151532.png","x":-182,"y":2120,"width":890,"height":384},
		{"id":"b378be651c9360b2","type":"text","text":"From here, we can browse to http://ir.inlanefreight.local/wp-login.php and log in using the credentials ilfreightwp:password1. Once logged in, we'll be directed to **http://ir.inlanefreight.local/wp-admin/** where we can browse to h**ttp://ir.inlanefreight.local/wp-admin/theme-editor.php?file=404.php&theme=twentytwenty** to edit the 404.php file for the inactive theme Twenty Twenty and add in a PHP web shell to get remote code execution. After editing this page and achieving code execution following the steps in the Attacking WordPress section of the Attacking Common Applications module, we can record yet another finding for Weak WordPress Admin Credentials and recommend that our client implement several hardening measures if they plan to leave this WordPress site exposed externally.","x":880,"y":2202,"width":941,"height":220},
		{"id":"930ac081dd8e36d7","type":"text","text":"after bruteforcing the ilfreightwp user. we are logged in in WordPress","x":1110,"y":2600,"width":481,"height":100},
		{"id":"bb6a8abd7afecdc1","type":"file","file":"Pasted image 20250107142448.png","x":959,"y":2840,"width":784,"height":530},
		{"id":"9a4875244b6ba36f","type":"file","file":"Pasted image 20250107143743.png","x":879,"y":3640,"width":945,"height":351},
		{"id":"f97bad71f904f228","type":"text","text":"We customize a theme, then insert a webshell then curl it ","x":1209,"y":4140,"width":285,"height":105},
		{"id":"7b9e348084de07ce","type":"file","file":"Pasted image 20250107143838.png","x":875,"y":4400,"width":953,"height":144,"color":"4"},
		{"id":"465cbe1c534d9bcd","type":"text","text":"Findings","x":1289,"y":4620,"width":125,"height":60,"color":"1"},
		{"id":"5e357f26566646d3","type":"text","text":"Weak Admin Credentials","x":900,"y":4780,"width":250,"height":60,"color":"6"},
		{"id":"42273b43f934c61c","type":"text","text":"Local File Inclusion","x":1227,"y":4783,"width":250,"height":55,"color":"6"}
	],
	"edges":[
		{"id":"52c0544da46a65af","fromNode":"67612794f230ac57","fromSide":"bottom","toNode":"943a91f8aa3ac0f3","toSide":"top"},
		{"id":"3e477108005394a1","fromNode":"943a91f8aa3ac0f3","fromSide":"right","toNode":"ab6d21dc3bf9b9c1","toSide":"left"},
		{"id":"ea62a91ef7f1f98b","fromNode":"ab6d21dc3bf9b9c1","fromSide":"bottom","toNode":"7da8c627962fc8fe","toSide":"top"},
		{"id":"267ab2fdbf258274","fromNode":"7da8c627962fc8fe","fromSide":"bottom","toNode":"f7ba56c4c36b59f7","toSide":"top"},
		{"id":"0b97718ad6597d5a","fromNode":"f7ba56c4c36b59f7","fromSide":"bottom","toNode":"c3591316b1de10b6","toSide":"top"},
		{"id":"dbf9d635612e170e","fromNode":"c3591316b1de10b6","fromSide":"bottom","toNode":"430e66de81184f85","toSide":"top"},
		{"id":"6abed2a47d58f887","fromNode":"430e66de81184f85","fromSide":"bottom","toNode":"a509c3c8691c4f49","toSide":"top"},
		{"id":"bfe4f6475a57a35b","fromNode":"a509c3c8691c4f49","fromSide":"bottom","toNode":"45aecbeabfc38fc7","toSide":"top"},
		{"id":"7e196087c340a999","fromNode":"45aecbeabfc38fc7","fromSide":"right","toNode":"b378be651c9360b2","toSide":"left"},
		{"id":"6688053afe12c152","fromNode":"b378be651c9360b2","fromSide":"bottom","toNode":"930ac081dd8e36d7","toSide":"top"},
		{"id":"f548b4caecb0e45d","fromNode":"930ac081dd8e36d7","fromSide":"bottom","toNode":"bb6a8abd7afecdc1","toSide":"top"},
		{"id":"a87e135a3034dbc6","fromNode":"bb6a8abd7afecdc1","fromSide":"bottom","toNode":"9a4875244b6ba36f","toSide":"top"},
		{"id":"e8a21b90cd3ceed2","fromNode":"9a4875244b6ba36f","fromSide":"bottom","toNode":"f97bad71f904f228","toSide":"top"},
		{"id":"167c795872fba6f8","fromNode":"f97bad71f904f228","fromSide":"bottom","toNode":"7b9e348084de07ce","toSide":"top"},
		{"id":"f9d9111a7f7e63b5","fromNode":"465cbe1c534d9bcd","fromSide":"left","toNode":"5e357f26566646d3","toSide":"top"},
		{"id":"229c1150aaa36edf","fromNode":"465cbe1c534d9bcd","fromSide":"bottom","toNode":"42273b43f934c61c","toSide":"top"},
		{"id":"089db87b2ce32f1a","fromNode":"7b9e348084de07ce","fromSide":"bottom","toNode":"465cbe1c534d9bcd","toSide":"bottom"}
	]
}