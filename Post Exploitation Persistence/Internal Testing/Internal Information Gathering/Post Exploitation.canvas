{
	"nodes":[
		{"id":"d108fa99ed1d145c","type":"text","text":"Can any of these users be leveraged to access a host in the protected network?\n\nLooking at the network adapters on the Domain Controllers we can see that it has a second NIC in the 172.16.9.0 network.","x":-660,"y":-440,"width":472,"height":161},
		{"id":"45821bd504576310","type":"file","file":"Pasted image 20250112124705.png","x":-660,"y":-120,"width":833,"height":484},
		{"id":"d25af3c73d927618","type":"text","text":"The Double Pivot - MGMT01","x":-373,"y":500,"width":260,"height":60,"color":"4"},
		{"id":"920c39ef4812499f","type":"text","text":"Now there are a few ways to do this next part, we'll take the long route so we can ultimately SSH directly into the 172.16.9.25 host from our attack box, performing a bit of a mindbending double pivot in the process. Here is what we are trying to achieve, starting from our attack host and pivoting through the dmz01 and DC01 hosts to be able to SSH directly into the MGMT01 host two hops away directly from our attack host.\n\nAttack host --> dmz01 --> DC01 --> MGMT01\n\nWe'll need to establish a reverse shell from the dmz01 box back to our attack host. We can do this the same we way did in the Internal Information Gathering section, creating an ELF payload, uploading it to the target and executing it to catch a shell. Start by creating the ELF payload and uploading it back to the dmz01 host via SCP if you removed it.\n\nNext, set up the Metasploit exploit/multi/handler.","x":-610,"y":720,"width":733,"height":373},
		{"id":"22ad18b65f5b13e6","type":"file","file":"Pasted image 20250112124938.png","x":80,"y":422,"width":1341,"height":217,"color":"4"},
		{"id":"fb53cba2a42c141a","type":"text","text":"\n## The Double Pivot - MGMT01","x":800,"y":1220,"width":400,"height":74,"color":"4"},
		{"id":"cb5ff22928cf4020","type":"text","text":"Attack host --> dmz01 --> DC01 --> MGMT01","x":800,"y":1420,"width":405,"height":60,"color":"4"},
		{"id":"a0e26e5f1fa0331c","type":"file","file":"Pasted image 20250112141823.png","x":-509,"y":1660,"width":3023,"height":1249},
		{"id":"9ef9f31dd8fc6ae8","type":"text","text":"Next, set up a local port forwarding rule to forward all traffic destined to port 1234 on dmz01 to port 8443 on our attack host.","x":825,"y":3200,"width":355,"height":124,"color":"4"},
		{"id":"c84b693d4f8d2735","type":"file","file":"Pasted image 20250112141959.png","x":45,"y":3520,"width":1916,"height":243},
		{"id":"b08c6c72807bc885","type":"text","text":"Next, create an executable payload that we'll upload to the Domain Controller host.","x":700,"y":3880,"width":606,"height":83,"color":"1"},
		{"id":"58bde4941bca891e","type":"file","file":"Pasted image 20250112142114.png","x":457,"y":4120,"width":1092,"height":245},
		{"id":"36d7fc054c195d3e","type":"file","file":"Pasted image 20250112142225.png","x":426,"y":4600,"width":1154,"height":288},
		{"id":"89bcab5b359a7924","type":"file","file":"Pasted image 20250112142416.png","x":253,"y":5100,"width":1501,"height":311},
		{"id":"06a0eecb8fd9daf6","type":"file","file":"Pasted image 20250112142429.png","x":588,"y":5600,"width":830,"height":128},
		{"id":"25b5289fb2c7efa4","type":"file","file":"Pasted image 20250112142442.png","x":9,"y":5940,"width":1989,"height":241},
		{"id":"195dade304ecaee4","type":"text","text":"For our next trick we'll set up a route to the 172.16.9.0/23 subnet.","x":848,"y":6300,"width":310,"height":87,"color":"4"},
		{"id":"89f2fed271136176","type":"file","file":"Pasted image 20250112142648.png","x":499,"y":6500,"width":1009,"height":227},
		{"id":"e75c13c8a61a9c5a","type":"text","text":"Now we need to set up a socks proxy which is the final step before we can communicate directly with the 172.16.9.0/23 network from our attack host.","x":1940,"y":6560,"width":397,"height":107,"color":"4"},
		{"id":"b7a0433f73b03196","type":"file","file":"Pasted image 20250112150951.png","x":1240,"y":7000,"width":715,"height":386},
		{"id":"2631de0ea7821723","type":"file","file":"Pasted image 20250112151006.png","x":1081,"y":7740,"width":1034,"height":544},
		{"id":"930d45d896121cda","type":"text","text":"As a final step we'll enumerate the target system, checking for local privilege escalation opportunities. If we can get root-level access we'll have fulfilled the client's main goal, as they stated that this server holds their \"crown jewels\", or most important data. During our enumeration we do a Google search based off of the Kernel version and see that it's likely vulnerable to the DirtyPipe, CVE-2022-0847. We can read an excellent explanation of this vulnerability on the Hack The Box blog.","x":1140,"y":8500,"width":742,"height":180,"color":"4"},
		{"id":"658232d125d6f63c","type":"text","text":"We'll use exploit-2 from this GitHub repo. Since we have SSH access to the system, we can create a file with Vim and paste the exploit code in. We then must compile it, and luckily gcc is present on the system.","x":2020,"y":8525,"width":674,"height":131,"color":"4"},
		{"id":"0bd8837fadd6f3d3","type":"file","file":"Pasted image 20250112152238.png","x":1960,"y":8840,"width":794,"height":300},
		{"id":"9391ca1b2f7215dd","type":"file","file":"Pasted image 20250112153115.png","x":1896,"y":9260,"width":922,"height":160},
		{"id":"642e56c4411ef4c2","type":"file","file":"Pasted image 20250112153135.png","x":1791,"y":9560,"width":1132,"height":156},
		{"id":"5f9372e1e935b92c","type":"text","text":"This section showed a sampling of the things we can do AFTER achieving Domain Admin in a client environment. Showing up, pwning the client and showing off how fast you got DA does no good for the client and does not help you and your firm retain clients and spread a solid reputation around. What we do after achieving Domain Admin is extremely important and this is where we can set ourselves apart from other testers who just run Responder, a few other tools and scripts, a Nessus scan, and issue a stock report and call it a day. Your report deliverable should demonstrate the worth of the penetration test your client is paying for and we can make sure they are happy and come back in the following years if we go above and beyond. This is not always possible due to contract restrictions and time-boxed assessments, but even if we can provide a little extra we're ahead of the pack. Keep in mind that the things we identify in our report can impact a client's funding for the following year and that funding likely includes penetration tests. We don't want to inflate the report with nonsensical findings, of course, but we can often identify many things that our client had never even considered and they and you will be better for it.","x":1943,"y":9840,"width":828,"height":349}
	],
	"edges":[
		{"id":"717d631bbbb8dfba","fromNode":"d108fa99ed1d145c","fromSide":"bottom","toNode":"45821bd504576310","toSide":"top"},
		{"id":"8a1c38947fe94d9b","fromNode":"45821bd504576310","fromSide":"bottom","toNode":"d25af3c73d927618","toSide":"top"},
		{"id":"442b6722c7320806","fromNode":"d25af3c73d927618","fromSide":"bottom","toNode":"920c39ef4812499f","toSide":"top"},
		{"id":"6ca56efafddc7440","fromNode":"d25af3c73d927618","fromSide":"right","toNode":"22ad18b65f5b13e6","toSide":"left"},
		{"id":"380244cd07a98f2b","fromNode":"920c39ef4812499f","fromSide":"bottom","toNode":"fb53cba2a42c141a","toSide":"left"},
		{"id":"d2560a569f7c8d01","fromNode":"22ad18b65f5b13e6","fromSide":"bottom","toNode":"fb53cba2a42c141a","toSide":"top"},
		{"id":"4992454b945c1bd7","fromNode":"fb53cba2a42c141a","fromSide":"bottom","toNode":"cb5ff22928cf4020","toSide":"top"},
		{"id":"d31dc46939b9f017","fromNode":"cb5ff22928cf4020","fromSide":"bottom","toNode":"a0e26e5f1fa0331c","toSide":"top"},
		{"id":"787deb11eafb6dc9","fromNode":"a0e26e5f1fa0331c","fromSide":"bottom","toNode":"9ef9f31dd8fc6ae8","toSide":"top"},
		{"id":"3b00f6754216c5e3","fromNode":"9ef9f31dd8fc6ae8","fromSide":"bottom","toNode":"c84b693d4f8d2735","toSide":"top"},
		{"id":"d7f1e39f0da823d5","fromNode":"c84b693d4f8d2735","fromSide":"bottom","toNode":"b08c6c72807bc885","toSide":"top"},
		{"id":"f57f6c4d7313dda9","fromNode":"b08c6c72807bc885","fromSide":"bottom","toNode":"58bde4941bca891e","toSide":"top"},
		{"id":"5d2cb426f6e27f29","fromNode":"58bde4941bca891e","fromSide":"bottom","toNode":"36d7fc054c195d3e","toSide":"top"},
		{"id":"86d68c88729b89f7","fromNode":"36d7fc054c195d3e","fromSide":"bottom","toNode":"89bcab5b359a7924","toSide":"top"},
		{"id":"e6d16e9afd9d9cb7","fromNode":"89bcab5b359a7924","fromSide":"bottom","toNode":"06a0eecb8fd9daf6","toSide":"top"},
		{"id":"824aa7470cc926f6","fromNode":"06a0eecb8fd9daf6","fromSide":"bottom","toNode":"25b5289fb2c7efa4","toSide":"top"},
		{"id":"eb00b3ee89200785","fromNode":"25b5289fb2c7efa4","fromSide":"bottom","toNode":"195dade304ecaee4","toSide":"top"},
		{"id":"d4d5732b14c79a72","fromNode":"195dade304ecaee4","fromSide":"bottom","toNode":"89f2fed271136176","toSide":"top"},
		{"id":"c44bd7c3f8138882","fromNode":"89f2fed271136176","fromSide":"right","toNode":"e75c13c8a61a9c5a","toSide":"left"},
		{"id":"fd649f3aa92af40e","fromNode":"e75c13c8a61a9c5a","fromSide":"bottom","toNode":"b7a0433f73b03196","toSide":"top"},
		{"id":"f9914aa7bf5af36a","fromNode":"b7a0433f73b03196","fromSide":"bottom","toNode":"2631de0ea7821723","toSide":"top"},
		{"id":"3dace9c871eb4ab5","fromNode":"2631de0ea7821723","fromSide":"bottom","toNode":"930d45d896121cda","toSide":"top"},
		{"id":"b273f324bc4ee5f5","fromNode":"930d45d896121cda","fromSide":"right","toNode":"658232d125d6f63c","toSide":"left"},
		{"id":"54931ba3ab77c917","fromNode":"658232d125d6f63c","fromSide":"bottom","toNode":"0bd8837fadd6f3d3","toSide":"top"},
		{"id":"bd1d3d8ad69df3e0","fromNode":"0bd8837fadd6f3d3","fromSide":"bottom","toNode":"9391ca1b2f7215dd","toSide":"top"},
		{"id":"21b4c44f89868fb1","fromNode":"9391ca1b2f7215dd","fromSide":"bottom","toNode":"642e56c4411ef4c2","toSide":"top"},
		{"id":"0756c3310076618c","fromNode":"642e56c4411ef4c2","fromSide":"bottom","toNode":"5f9372e1e935b92c","toSide":"top"}
	]
}